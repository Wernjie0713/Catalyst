import{j as t,r as m}from"./index-D3Bj6weo.js";import{m as I,a as L}from"./index.esm-CYkcvaz4.js";import{A as M}from"./index-IFTv2SK_.js";import{m as v}from"./proxy-0rKmIGA_.js";import{f as D}from"./format-CGyNCyRw.js";const R=({tags:l,className:d="",maxDisplay:i=3,showCount:c=!0})=>{if(!l||!Array.isArray(l)||l.length===0)return null;const x=l.slice(0,i),r=l.length-i,a=e=>["Technical Skills","Soft Skills","Critical Thinking","Research & Analysis","Creativity & Innovation","Business Acumen","Digital Literacy"].includes(e)?"bg-blue-500/20 text-blue-300 border-blue-500/30":["Introductory","Intermediate","Advanced"].includes(e)?"bg-green-500/20 text-green-300 border-green-500/30":["Lecture","Workshop","Hackathon","Group Project","Mentorship","Panel","Networking"].includes(e)?"bg-purple-500/20 text-purple-300 border-purple-500/30":["Career Exploration","Industry Exposure","Portfolio Development","Internship Pipeline","Capstone Prep"].includes(e)?"bg-orange-500/20 text-orange-300 border-orange-500/30":"bg-gray-500/20 text-gray-300 border-gray-500/30";return t.jsxs("div",{className:`flex flex-wrap gap-1.5 ${d}`,children:[x.map((e,u)=>t.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full border ${a(e)} transition-colors`,title:e,children:e},u)),r>0&&c&&t.jsxs("span",{className:"px-2 py-1 text-xs font-medium rounded-full border bg-gray-600/20 text-gray-400 border-gray-600/30",title:`${r} more tags: ${l.slice(i).join(", ")}`,children:["+",r]})]})};function Y({event:l,isOpen:d,onClose:i,onEventUpdate:c,auth:x}){var f,j;if(!d)return null;const[r,a]=m.useState(!1),[e,u]=m.useState(l),[o,y]=m.useState(null),[_,N]=m.useState([]),[w,g]=m.useState(!1),{post:E,delete:T,data:p,setData:$,reset:C}=I({team_id:""});m.useEffect(()=>{u({...l,is_enrolled:!!l.is_enrolled})},[l]),m.useEffect(()=>{d&&e.is_team_event&&!e.is_enrolled&&!e.is_external&&S()},[d,e.event_id,e.is_team_event]);const S=async()=>{g(!0);try{const s=await L.get(route("events.available-teams",e.event_id));N(s.data)}catch(s){console.error("Failed to load teams:",s)}finally{g(!1)}},b=e.is_team_event?e.enrolled_teams_count/e.max_participants*100:e.enrolled_count/e.max_participants*100,k=s=>{const h=s.target.value;$("team_id",h),y(_.find(n=>n.id===h))},A=()=>{if(a(!0),e.is_team_event&&!e.is_external&&!p.team_id){alert("Please select a team to enroll"),a(!1);return}E(route("events.enroll",e.event_id),{preserveScroll:!0,onSuccess:()=>{a(!1),u(s=>({...s,is_enrolled:!0,enrolled_count:s.is_team_event?s.enrolled_count+((o==null?void 0:o.members_count)||0):s.enrolled_count+1,enrolled_teams_count:s.is_team_event?(s.enrolled_teams_count||0)+1:s.enrolled_teams_count})),c&&c({...e,is_enrolled:!0,enrolled_count:e.is_team_event?e.enrolled_count+((o==null?void 0:o.members_count)||0):e.enrolled_count+1,enrolled_teams_count:e.is_team_event?(e.enrolled_teams_count||0)+1:e.enrolled_teams_count,enrolled_team:o}),C()},onError:()=>a(!1)})},P=()=>{a(!0),T(route("events.unenroll",e.event_id),{preserveScroll:!0,onSuccess:()=>{var h;a(!1);const s=((h=e.enrolled_team)==null?void 0:h.member_count)||1;u(n=>({...n,is_enrolled:!1,enrolled_count:n.is_team_event?n.enrolled_count-s:n.enrolled_count-1,enrolled_teams_count:n.is_team_event?(n.enrolled_teams_count||0)-1:n.enrolled_teams_count,enrolled_team:null})),c&&c({...e,is_enrolled:!1,enrolled_count:e.is_team_event?e.enrolled_count-s:e.enrolled_count-1,enrolled_teams_count:e.is_team_event?(e.enrolled_teams_count||0)-1:e.enrolled_teams_count,enrolled_team:null})},onError:()=>a(!1)})},z=()=>{window.open(e.registration_url,"_blank")};return t.jsx(M,{children:t.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:t.jsxs("div",{className:"flex min-h-screen items-center justify-center p-4",children:[t.jsx(v.div,{style:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:i,className:"fixed inset-0 bg-black/60 backdrop-blur-sm"}),t.jsxs(v.div,{style:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"relative w-full max-w-2xl rounded-2xl bg-[#1E1E2E] shadow-xl",children:[t.jsx("button",{onClick:i,className:"absolute right-4 top-4 z-10 text-gray-400 hover:text-white transition-colors p-2 hover:bg-gray-700/50 rounded-full",children:t.jsx("span",{className:"material-symbols-outlined",children:"close"})}),t.jsxs("div",{className:"relative h-48 rounded-t-2xl overflow-hidden",children:[t.jsx("img",{src:e.cover_image?`/${e.cover_image}`:"/default-event-image.jpg",alt:e.title,className:"w-full h-full object-cover"}),t.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-[#1E1E2E] to-transparent"})]}),t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"mb-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h2",{className:"text-2xl font-bold text-white",children:e.title}),t.jsxs("div",{className:"flex items-center space-x-2",children:[e.is_external&&t.jsx("span",{className:"px-3 py-1 rounded-full text-sm font-medium bg-purple-500/20 text-purple-400",children:"External Event"}),e.is_team_event&&t.jsx("span",{className:"px-3 py-1 rounded-full text-sm font-medium bg-blue-500/20 text-blue-400",children:"Team Event"}),t.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${e.status==="Upcoming"?"bg-green-500/20 text-green-400":e.status==="Ongoing"?"bg-blue-500/20 text-blue-400":"bg-gray-500/20 text-gray-400"}`,children:e.status})]})]}),t.jsx("p",{className:"text-gray-400 mt-1",children:e.is_external?`Organized by ${e.organizer_name}`:`Created by ${e.creator.name}`})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-2",children:"Date & Time"}),t.jsxs("div",{className:"flex items-center text-white",children:[t.jsx("span",{className:"material-symbols-outlined mr-2 text-blue-400",children:"calendar_today"}),t.jsxs("span",{children:[D(new Date(e.date),"MMMM dd, yyyy")," at ",e.formatted_time]})]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-2",children:"Location"}),t.jsxs("div",{className:"flex items-center text-white",children:[t.jsx("span",{className:"material-symbols-outlined mr-2 text-green-400",children:"location_on"}),t.jsx("span",{children:e.location})]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-2",children:"Event Type"}),t.jsxs("div",{className:"flex items-center text-white",children:[t.jsx("span",{className:"material-symbols-outlined mr-2 text-purple-400",children:"category"}),t.jsx("span",{children:e.event_type})]})]}),e.is_team_event&&!e.is_external&&t.jsxs("div",{children:[t.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-2",children:"Team Requirements"}),t.jsxs("div",{className:"flex items-center text-white",children:[t.jsx("span",{className:"material-symbols-outlined mr-2 text-amber-400",children:"group"}),t.jsx("span",{children:e.min_team_members===e.max_team_members?`Exactly ${e.min_team_members} members per team`:`${e.min_team_members}-${e.max_team_members} members per team`})]})]}),!e.is_external&&t.jsxs("div",{children:[t.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-2",children:e.is_team_event?"Team Enrollment Status":"Enrollment Status"}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsx("span",{className:"text-white",children:e.is_team_event?`${e.enrolled_teams_count||0} teams enrolled of ${e.max_participants} spots`:`${e.enrolled_count} enrolled of ${e.max_participants} spots`}),t.jsx("span",{className:"text-white",children:e.is_team_event?`${((e.enrolled_teams_count||0)/e.max_participants*100).toFixed(0)}%`:`${(e.enrolled_count/e.max_participants*100).toFixed(0)}%`})]}),t.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2",children:t.jsx("div",{className:`h-2 rounded-full ${b>=90?"bg-red-500":b>=75?"bg-yellow-500":"bg-green-500"}`,style:{width:`${Math.min(b,100)}%`}})})]})]}),e.is_enrolled&&e.is_team_event&&e.enrolled_team&&t.jsxs("div",{children:[t.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-2",children:"Your Team"}),t.jsxs("div",{className:"flex items-center text-white",children:[t.jsx("span",{className:"material-symbols-outlined mr-2 text-indigo-400",children:"people"}),t.jsxs("span",{children:[e.enrolled_team.name," (",e.enrolled_team.member_count," members)"]})]})]}),e.is_external&&e.organizer_website&&t.jsxs("div",{children:[t.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-2",children:"Organizer Website"}),t.jsxs("div",{className:"flex items-center text-white",children:[t.jsx("span",{className:"material-symbols-outlined mr-2 text-blue-400",children:"language"}),t.jsx("a",{href:e.organizer_website,target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300 transition-colors",children:"Visit Website"})]})]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-2",children:"Description"}),t.jsx("p",{className:"text-white whitespace-pre-line",children:e.description})]}),e.label_tags&&e.label_tags.length>0&&t.jsxs("div",{className:"mt-6",children:[t.jsxs("h3",{className:"text-sm font-medium text-gray-400 mb-3 flex items-center gap-2",children:[t.jsx("span",{className:"material-symbols-outlined text-sm text-indigo-400",children:"label"}),"Event Categories"]}),t.jsx(R,{tags:e.label_tags,maxDisplay:50,showCount:!1,className:"gap-2"})]}),e.is_team_event&&!e.is_external&&!e.is_enrolled&&e.status==="Upcoming"&&t.jsxs("div",{className:"mt-6",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-2",children:"Select Your Team"}),w?t.jsx("div",{className:"text-gray-400",children:"Loading available teams..."}):_.length===0?t.jsxs("div",{children:[t.jsx("div",{className:"text-amber-400",children:"You don't have any eligible teams that meet the size requirements. Create a team or adjust your existing team before enrolling."}),t.jsx("div",{children:t.jsx("span",{className:"text-xs text-red-400 mt-1",children:"*Only Team Leaders can unenroll their teams."})})]}):t.jsxs("select",{value:p.team_id,onChange:k,className:"w-full bg-[#2A2A3A] border border-gray-700 rounded-lg px-4 py-2 text-white",children:[t.jsx("option",{value:"",children:"Select a team"}),_.map(s=>t.jsxs("option",{value:s.id,children:[s.name," (",s.members_count," members)"]},s.id))]})]}),t.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[t.jsx("button",{onClick:i,className:"px-4 py-2 text-gray-400 hover:text-white transition-colors",children:"Close"}),e.is_external?t.jsx("button",{onClick:z,className:"px-4 py-2 bg-purple-500 hover:bg-purple-600 text-white rounded-lg transition-colors",children:"Register at External Site"}):e.is_enrolled?e.is_team_event&&e.enrolled_team&&e.enrolled_team.creator_id!==((f=x==null?void 0:x.user)==null?void 0:f.id)?t.jsxs("div",{className:"flex flex-col items-end",children:[t.jsx("button",{disabled:!0,className:"px-4 py-2 bg-gray-500 text-white rounded-lg transition-colors opacity-50 cursor-not-allowed",children:"Team Leader Action Required"}),t.jsxs("span",{className:"text-xs text-yellow-400 mt-1",children:["Only ",((j=e.enrolled_team.creator)==null?void 0:j.name)||"the team leader"," can unenroll the team"]})]}):t.jsx("button",{onClick:P,disabled:r||e.status!=="Upcoming",className:"px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:r?"Processing...":e.is_team_event?"Unenroll Team":"Unenroll"}):t.jsx("button",{onClick:A,disabled:r||e.status!=="Upcoming"||(e.is_team_event?e.enrolled_teams_count>=e.max_participants||!p.team_id||_.length===0:e.enrolled_count>=e.max_participants),className:"px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:r?"Processing...":e.is_team_event?e.enrolled_teams_count>=e.max_participants?"Event Full":_.length===0?"No Eligible Teams":"Enroll Team":e.enrolled_count>=e.max_participants?"Event Full":"Enroll Now"})]})]})]})]})})})}export{Y as E,R as T};
