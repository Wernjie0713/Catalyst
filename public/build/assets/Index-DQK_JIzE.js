import{r as d,j as e}from"./index-D3Bj6weo.js";import{K as O,L as U,$}from"./index.esm-CYkcvaz4.js";import{A as q}from"./AuthenticatedLayout-DgmrdonU.js";import{C as z,r as I,D as T,L as K}from"./index-BpekFtwt.js";import"./en-US-DNUEYIb-.js";z.register(...I);function Q({auth:r}){var w,_,A,C,M,S,F,L;const{report:s}=O().props,l=(r==null?void 0:r.user)||{},o=((w=s==null?void 0:s.data)==null?void 0:w.students)??(s==null?void 0:s.students)??((A=(_=s==null?void 0:s.data)==null?void 0:_.department_metrics)==null?void 0:A.students)??[],i=(C=l==null?void 0:l.department_staff)==null?void 0:C.faculty,g=(M=l==null?void 0:l.department_staff)==null?void 0:M.university,p=d.useMemo(()=>o.filter(t=>(!g||t.university===g)&&(!i||t.faculty===i)),[o,i,g]),c=((S=s==null?void 0:s.data)==null?void 0:S.metrics)||{},v=((L=(F=s==null?void 0:s.data)==null?void 0:F.department_metrics)==null?void 0:L.event_participation)||[],[h,P]=d.useState(""),[D,j]=d.useState(1),m=6,a=d.useMemo(()=>{const t=h.trim().toLowerCase();return t?p.filter(u=>(u.name||"").toLowerCase().includes(t)||(u.matric_no||"").toLowerCase().includes(t)):p},[p,h]),x=Math.max(1,Math.ceil((Array.isArray(a)?a.length:0)/m)),n=Math.min(Math.max(D,1),x),k=d.useMemo(()=>{if(!Array.isArray(a))return[];const t=(n-1)*m;return a.slice(t,t+m)},[a,n]),N=a.length||c.total_students||0,b=c.active_students||0,R=c.total_certificates||0;c.events_participated;const E={labels:["Active","Others"],datasets:[{data:[b,Math.max(N-b,0)],backgroundColor:["#F37022","#fde7da"],borderColor:["#F37022","#fde7da"]}]};return e.jsxs(q,{user:r.user,children:[e.jsx(U,{title:"Department Report"}),e.jsx("div",{className:"py-6 sm:py-12 bg-gray-50 min-h-screen",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsx("div",{children:e.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 flex items-center",children:[e.jsx("span",{className:"material-symbols-outlined text-[#F37022] mr-2 sm:mr-3",children:"analytics"}),"Department Report"]})}),e.jsx("div",{className:"w-full sm:w-72",children:e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"material-symbols-outlined absolute left-3 top-2.5 text-[#F37022]",children:"search"}),e.jsx("input",{value:h,onChange:t=>P(t.target.value),placeholder:"Search students by name or matric no",className:"w-full pl-10 pr-4 py-2.5 rounded-md border border-gray-300 focus:ring-2 focus:ring-orange-200 focus:border-[#F37022] bg-white"})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6 mb-6 sm:mb-8",children:[e.jsx(f,{label:"Total Students",value:N,icon:"school"}),e.jsx(f,{label:"Active Students",value:b,icon:"bolt"}),e.jsx(f,{label:"Certificates",value:R,icon:"military_tech"}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-4 sm:p-5",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-2",children:"Active vs Others"}),e.jsx("div",{className:"h-24 sm:h-28",children:e.jsx(T,{data:E,options:{plugins:{legend:{display:!1}},maintainAspectRatio:!1}})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-4 sm:p-5 mb-6 sm:mb-8",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3 text-gray-800 font-medium",children:[e.jsx("span",{className:"material-symbols-outlined text-[#F37022]",children:"timeline"}),"Monthly Events"]}),e.jsx("div",{className:"h-40 sm:h-48",children:e.jsx(K,{data:{labels:v.map(t=>t.month),datasets:[{label:"Events",data:v.map(t=>t.count),borderColor:"#F37022",backgroundColor:"rgba(243,112,34,0.15)",fill:!0,tension:.35,borderWidth:2}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{x:{grid:{display:!1}},y:{beginAtZero:!0,grid:{color:"#f1f5f9"}}}}})})]}),Array.isArray(a)&&a.length===0?e.jsx("div",{className:"bg-white rounded-xl border border-gray-100 shadow p-6 sm:p-12 text-center text-gray-500",children:"No students found."}):Array.isArray(a)?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:k.map((t,u)=>e.jsx($,{href:route("profile.view",t.user_id),className:"group bg-white rounded-xl border border-gray-200 shadow-sm hover:shadow-md hover:border-orange-300 transition block",children:e.jsxs("div",{className:"p-4 sm:p-5",children:[e.jsxs("div",{className:"flex items-start gap-3 sm:gap-4",children:[e.jsx(V,{name:t.name}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("h3",{className:"font-semibold text-gray-900 truncate max-w-[180px] sm:max-w-[220px]",children:t.name}),t.is_active&&e.jsx("span",{className:"px-2 py-0.5 text-xs rounded-full bg-green-100 text-green-700",children:"Active"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:t.matric_no}),e.jsxs("div",{className:"mt-2 flex items-center gap-2 text-xs text-gray-500",children:[e.jsx("span",{className:"material-symbols-outlined text-sm",children:"apartment"}),e.jsxs("span",{className:"truncate",children:[t.university," â€¢ ",t.faculty]})]})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-3 gap-2 sm:gap-3",children:[e.jsx(y,{icon:"folder",label:"Projects",value:t.projects_count,color:"indigo"}),e.jsx(y,{icon:"military_tech",label:"Certs",value:t.certificates_count,color:"violet"}),e.jsx(y,{icon:"schedule",label:"Updated",value:t.updated_at?new Date(t.updated_at).toLocaleDateString():"-",color:"slate"})]})]})},t.user_id||u))}):null,Array.isArray(a)&&a.length>m&&e.jsxs("div",{className:"mt-6 flex items-center justify-center gap-2",children:[e.jsx("button",{onClick:()=>j(t=>Math.max(1,t-1)),className:"px-3 py-1.5 text-sm border rounded-md bg-white hover:bg-orange-50 border-gray-300 disabled:opacity-50 disabled:cursor-not-allowed",disabled:n===1,children:"Prev"}),e.jsxs("span",{className:"text-sm text-gray-600 px-2",children:["Page ",n," of ",x]}),e.jsx("button",{onClick:()=>j(t=>Math.min(x,t+1)),className:"px-3 py-1.5 text-sm border rounded-md bg-white hover:bg-orange-50 border-gray-300 disabled:opacity-50 disabled:cursor-not-allowed",disabled:n===x,children:"Next"})]})]})})]})}function f({label:r,value:s,icon:l}){return e.jsxs("div",{className:"px-3 sm:px-4 py-4 rounded-xl bg-white border border-gray-200 shadow-sm",children:[e.jsxs("div",{className:"text-[#F37022] flex items-center gap-2",children:[e.jsx("span",{className:"material-symbols-outlined text-lg sm:text-xl",children:l}),e.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-700",children:r})]}),e.jsx("div",{className:"text-xl sm:text-2xl font-semibold text-gray-900 mt-1",children:s??0})]})}function y({icon:r,label:s,value:l,color:o="slate"}){const i={indigo:"text-indigo-600",violet:"text-violet-600",emerald:"text-emerald-600",slate:"text-slate-600",orange:"text-[#F37022]"};return e.jsxs("div",{className:"rounded-md bg-white border border-gray-200 p-2 sm:p-3",children:[e.jsxs("div",{className:"text-xs text-gray-600 flex items-center gap-1",children:[e.jsx("span",{className:`material-symbols-outlined text-xs sm:text-sm ${i[o]||"text-slate-600"}`,children:r}),e.jsx("span",{className:"hidden sm:inline",children:s}),e.jsx("span",{className:"sm:hidden",children:s.length>4?s.substring(0,4):s})]}),e.jsx("div",{className:"text-xs sm:text-sm font-semibold text-gray-900 mt-1",children:l})]})}function V({name:r}){const s=(r||"?").charAt(0).toUpperCase();return e.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 rounded-full bg-[#F37022] text-white flex items-center justify-center text-base sm:text-lg font-medium",children:s})}const J=Object.freeze(Object.defineProperty({__proto__:null,default:Q},Symbol.toStringTag,{value:"Module"}));export{J as _};
