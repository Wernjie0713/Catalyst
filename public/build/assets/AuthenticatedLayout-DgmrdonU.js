import{r as v,j as e}from"./index-D3Bj6weo.js";import{K as I,S as j}from"./index.esm-CYkcvaz4.js";import{t as p,c as H,n as L,a as E,g as P,e as W,d as z,f as k}from"./en-US-DNUEYIb-.js";function S(r,n){const s=+p(r)-+p(n);return s<0?-1:s>0?1:s}function B(r){return H(r,Date.now())}function K(r,n,s){const[l,a]=L(s==null?void 0:s.in,r,n),d=l.getFullYear()-a.getFullYear(),f=l.getMonth()-a.getMonth();return d*12+f}function U(r){return n=>{const l=(r?Math[r]:Math.trunc)(n);return l===0?0:l}}function q(r,n){return+p(r)-+p(n)}function G(r,n){const s=p(r,n==null?void 0:n.in);return s.setHours(23,59,59,999),s}function J(r,n){const s=p(r,n==null?void 0:n.in),l=s.getMonth();return s.setFullYear(s.getFullYear(),l+1,0),s.setHours(23,59,59,999),s}function Q(r,n){const s=p(r,n==null?void 0:n.in);return+G(s,n)==+J(s,n)}function V(r,n,s){const[l,a,d]=L(s==null?void 0:s.in,r,r,n),f=S(a,d),i=Math.abs(K(a,d));if(i<1)return 0;a.getMonth()===1&&a.getDate()>27&&a.setDate(30),a.setMonth(a.getMonth()-f*i);let h=S(a,d)===-f;Q(l)&&i===1&&S(l,d)===1&&(h=!1);const x=f*(i-+h);return x===0?0:x}function Z(r,n,s){const l=q(r,n)/1e3;return U(s==null?void 0:s.roundingMethod)(l)}function ee(r,n,s){const l=P(),a=(s==null?void 0:s.locale)??l.locale??W,d=2520,f=S(r,n);if(isNaN(f))throw new RangeError("Invalid time value");const i=Object.assign({},s,{addSuffix:s==null?void 0:s.addSuffix,comparison:f}),[h,x]=L(s==null?void 0:s.in,...f>0?[n,r]:[r,n]),u=Z(x,h),y=(E(x)-E(h))/1e3,c=Math.round((u-y)/60);let b;if(c<2)return s!=null&&s.includeSeconds?u<5?a.formatDistance("lessThanXSeconds",5,i):u<10?a.formatDistance("lessThanXSeconds",10,i):u<20?a.formatDistance("lessThanXSeconds",20,i):u<40?a.formatDistance("halfAMinute",0,i):u<60?a.formatDistance("lessThanXMinutes",1,i):a.formatDistance("xMinutes",1,i):c===0?a.formatDistance("lessThanXMinutes",1,i):a.formatDistance("xMinutes",c,i);if(c<45)return a.formatDistance("xMinutes",c,i);if(c<90)return a.formatDistance("aboutXHours",1,i);if(c<z){const m=Math.round(c/60);return a.formatDistance("aboutXHours",m,i)}else{if(c<d)return a.formatDistance("xDays",1,i);if(c<k){const m=Math.round(c/z);return a.formatDistance("xDays",m,i)}else if(c<k*2)return b=Math.round(c/k),a.formatDistance("aboutXMonths",b,i)}if(b=V(x,h),b<12){const m=Math.round(c/k);return a.formatDistance("xMonths",m,i)}else{const m=b%12,N=Math.trunc(b/12);return m<3?a.formatDistance("aboutXYears",N,i):m<9?a.formatDistance("overXYears",N,i):a.formatDistance("almostXYears",N+1,i)}}function te(r,n){return ee(r,B(r),n)}const se=()=>{var F,O;const{auth:r}=I().props,[n,s]=v.useState(!1),[l,a]=v.useState(!1),[d,f]=v.useState(!1),i=v.useRef(null),h=((F=r.user)==null?void 0:F.notifications)||[],x=((O=r.user)==null?void 0:O.unread_count)??0,u=t=>{var o,g;return(g=(o=r==null?void 0:r.user)==null?void 0:o.roles)==null?void 0:g.some(D=>D.name===t)},y=u("admin"),c=u("lecturer"),b=u("admin")||u("university")||u("department_staff");v.useEffect(()=>{const t=o=>{i.current&&!i.current.contains(o.target)&&f(!1)};return document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[]),v.useEffect(()=>{const t=()=>{a(window.innerWidth<768)};return t(),window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]);const m=t=>{const o=t.id,D=(t.data||{}).action_url||null;D?j.visit(D,{onFinish:()=>j.post(`/notifications/${o}/read`),preserveScroll:!0}):j.post(`/notifications/${o}/read`)},N=t=>{try{const o=new Date(t);return te(o,{addSuffix:!0})}catch{return t}},_=Math.max(x,h.filter(t=>!t.read_at).length),X=[{name:"Profile",icon:"person",route:"profile.show",path:"/profile",visible:!y},{name:"Dashboard",icon:"dashboard",route:"dashboard",path:"/dashboard",visible:!0},{name:"Event",icon:"celebration",route:"events.index",path:"/events",visible:!0},{name:"MyEvents",icon:"work_history",route:"events.my-events",path:"/my-events",visible:!0},{name:"Projects",icon:"folder_supervised",route:"projects.index",path:"/projects",visible:y||u("student")},{name:"Project Dashboard",icon:"school",route:"lecturer.dashboard",path:"/lecturer/dashboard",visible:c},{name:"Faculty Students",icon:"groups_3",route:"lecturer.students",path:"/lecturer/students",visible:c},{name:"My Mentees",icon:"group_add",route:"mentees.dashboard",path:"/mentees/dashboard",visible:c},{name:"Reports",icon:"analytics",route:"reports.index",path:"/reports",visible:b},{name:"Connections",icon:"group",route:"friends.list",path:"/friends",visible:u("student")||y},{name:"Notifications",icon:"notifications",badge:_>0?_:null,action:()=>f(!d),visible:!0},{name:"Roles Management",icon:"admin_panel_settings",route:"admin.roles.index",path:"/admin/roles",visible:y},{name:"Settings",icon:"settings",route:"settings.edit",path:"/settings",visible:!0},{name:"Logout",icon:"logout",method:"post",route:"logout",path:"/logout",visible:!0}],T="/images/Catalyst.png",M=X.filter(t=>t.visible),Y=()=>{const t=window.location.pathname;for(let o=0;o<M.length;o++){const g=M[o];if(g.path&&(t===g.path||g.path!=="/"&&t.startsWith(g.path)))return o}return-1},C=t=>{if(t.action){t.action();return}if(t.method==="post"){j.post(route(t.route));return}t.route?j.get(route(t.route)):t.path&&j.get(t.path)},w=Y(),R=()=>e.jsxs("div",{className:"md:hidden",children:[e.jsxs("button",{onClick:()=>s(!n),className:"fixed top-4 left-4 z-50 p-2 rounded-md bg-white text-[#F37022] border border-orange-200 shadow hover:bg-orange-50 focus:outline-none focus:ring-2 focus:ring-[#F37022] focus:ring-offset-2 focus:ring-offset-white",children:[e.jsx("span",{className:"sr-only",children:"Open menu"}),e.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n?e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"}):e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})]}),n&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40",onClick:()=>s(!1)}),e.jsx("div",{className:"fixed top-16 left-4 z-50 w-56 rounded-lg shadow-xl bg-white border border-orange-200",children:e.jsx("div",{className:"py-1",children:M.map((t,o)=>e.jsxs("button",{onClick:()=>C(t),className:`
                    w-full text-left px-4 py-2 text-sm flex items-center space-x-3
                    ${w===o?"bg-orange-50 text-[#F37022] font-medium":"text-gray-700 hover:bg-orange-50 hover:text-[#F37022]"}
                  `,children:[e.jsx("span",{className:"material-symbols-outlined text-lg",children:t.icon}),e.jsx("span",{children:t.name}),t.name==="Notifications"&&t.badge>0&&e.jsx("span",{className:"ml-auto bg-red-600 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:t.badge})]},o))})})]})]}),A=()=>e.jsx("section",{className:"page sidebar-page hidden md:block",children:e.jsx("aside",{className:"sidebar",children:e.jsxs("div",{className:"inner",children:[e.jsxs("div",{className:"header",children:[e.jsx("img",{src:T,className:"logo",alt:"Catalyst Logo"}),e.jsx("h2",{className:"text-black",children:"Catalyst"})]}),e.jsx("nav",{className:"menu",style:{"--top":`${w===-1?0:w*56}px`},children:M.map((t,o)=>e.jsxs("button",{className:w===o?"active":"",type:"button",onClick:()=>C(t),style:{position:"relative"},children:[e.jsxs("span",{className:"relative inline-flex items-center justify-center",children:[e.jsx("span",{className:"material-symbols-outlined",children:t.icon}),t.name==="Notifications"&&_>0&&e.jsx("span",{className:"absolute -top-1 -right-1 w-2.5 h-2.5 rounded-full bg-red-600"})]}),e.jsx("p",{children:t.name})]},o))})]})})}),$=()=>d&&e.jsx("div",{ref:i,className:"fixed left-24 top-4 w-96 bg-white dark:bg-gray-800 rounded-lg shadow-2xl border border-gray-200 dark:border-gray-700 overflow-hidden z-[9999] transition-all duration-300 ease-in-out",style:{maxHeight:"80vh",overflowY:"auto"},children:e.jsxs("div",{className:"py-2",children:[e.jsxs("div",{className:"px-4 py-3 font-medium border-b border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900 flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"material-symbols-outlined mr-2",children:"notifications"}),e.jsx("span",{children:"Notifications"})]}),h.length>0&&e.jsx("button",{onClick:()=>j.post("/notifications/mark-all-as-read"),className:"text-xs text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300",children:"Mark all as read"})]}),h.length===0?e.jsxs("div",{className:"px-4 py-12 text-gray-500 dark:text-gray-400 text-center",children:[e.jsx("span",{className:"material-symbols-outlined text-4xl mb-2 opacity-50",children:"notifications_off"}),e.jsx("p",{children:"No new notifications"})]}):e.jsx("div",{children:h.map(t=>e.jsx("div",{className:"px-4 py-3 hover:bg-gray-50 dark:hover:bg-gray-700 border-b border-gray-100 dark:border-gray-700 cursor-pointer transition-colors duration-150",onClick:()=>m(t),children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0 mr-3",children:e.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-100 dark:bg-blue-900 flex items-center justify-center text-blue-500 dark:text-blue-300",children:e.jsx("span",{className:"material-symbols-outlined",children:"event"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-sm font-medium text-gray-800 dark:text-gray-200 mb-1",children:t.data.message||"New notification"}),e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 flex items-center",children:[e.jsx("span",{className:"material-symbols-outlined text-xs mr-1",children:"schedule"}),N(t.created_at)]})]}),!t.read_at&&e.jsx("div",{className:"ml-2 w-2 h-2 bg-blue-600 rounded-full"})]})},t.id))})]})});return e.jsxs(e.Fragment,{children:[e.jsx(R,{}),e.jsx(A,{}),e.jsx($,{})]})};function ie({header:r,children:n}){const{auth:s}=I().props;I().props.auth.user;const[l,a]=v.useState(!1);return v.useEffect(()=>{const d=()=>{a(window.innerWidth<768)};return d(),window.addEventListener("resize",d),()=>window.removeEventListener("resize",d)},[]),e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-white to-orange-45 relative overflow-hidden overflow-x-hidden",children:[e.jsx(se,{}),e.jsx("main",{className:`
                transition-all duration-300 ease-in-out
                ${l?"flex flex-col items-center w-full":"ml-[84px]"}
            `,children:e.jsx("div",{className:`
                    ${l?"w-[calc(100%-45px)] mx-auto flex justify-center":""}
                `,children:n})})]})}export{ie as A};
