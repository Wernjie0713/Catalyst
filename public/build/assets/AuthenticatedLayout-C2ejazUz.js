import{r as v,j as e}from"./index-D3Bj6weo.js";import{K as I,S as p}from"./index.esm-CYkcvaz4.js";import{t as j,c as W,n as L,a as z,g as $,e as P,d as C,f as D}from"./en-US-DNUEYIb-.js";function S(r,n){const s=+j(r)-+j(n);return s<0?-1:s>0?1:s}function K(r){return W(r,Date.now())}function Q(r,n,s){const[c,a]=L(s==null?void 0:s.in,r,n),d=c.getFullYear()-a.getFullYear(),f=c.getMonth()-a.getMonth();return d*12+f}function U(r){return n=>{const c=(r?Math[r]:Math.trunc)(n);return c===0?0:c}}function B(r,n){return+j(r)-+j(n)}function q(r,n){const s=j(r,n==null?void 0:n.in);return s.setHours(23,59,59,999),s}function G(r,n){const s=j(r,n==null?void 0:n.in),c=s.getMonth();return s.setFullYear(s.getFullYear(),c+1,0),s.setHours(23,59,59,999),s}function J(r,n){const s=j(r,n==null?void 0:n.in);return+q(s,n)==+G(s,n)}function V(r,n,s){const[c,a,d]=L(s==null?void 0:s.in,r,r,n),f=S(a,d),i=Math.abs(Q(a,d));if(i<1)return 0;a.getMonth()===1&&a.getDate()>27&&a.setDate(30),a.setMonth(a.getMonth()-f*i);let m=S(a,d)===-f;J(c)&&i===1&&S(c,d)===1&&(m=!1);const x=f*(i-+m);return x===0?0:x}function Z(r,n,s){const c=B(r,n)/1e3;return U(s==null?void 0:s.roundingMethod)(c)}function ee(r,n,s){const c=$(),a=(s==null?void 0:s.locale)??c.locale??P,d=2520,f=S(r,n);if(isNaN(f))throw new RangeError("Invalid time value");const i=Object.assign({},s,{addSuffix:s==null?void 0:s.addSuffix,comparison:f}),[m,x]=L(s==null?void 0:s.in,...f>0?[n,r]:[r,n]),u=Z(x,m),y=(z(x)-z(m))/1e3,l=Math.round((u-y)/60);let b;if(l<2)return s!=null&&s.includeSeconds?u<5?a.formatDistance("lessThanXSeconds",5,i):u<10?a.formatDistance("lessThanXSeconds",10,i):u<20?a.formatDistance("lessThanXSeconds",20,i):u<40?a.formatDistance("halfAMinute",0,i):u<60?a.formatDistance("lessThanXMinutes",1,i):a.formatDistance("xMinutes",1,i):l===0?a.formatDistance("lessThanXMinutes",1,i):a.formatDistance("xMinutes",l,i);if(l<45)return a.formatDistance("xMinutes",l,i);if(l<90)return a.formatDistance("aboutXHours",1,i);if(l<C){const h=Math.round(l/60);return a.formatDistance("aboutXHours",h,i)}else{if(l<d)return a.formatDistance("xDays",1,i);if(l<D){const h=Math.round(l/C);return a.formatDistance("xDays",h,i)}else if(l<D*2)return b=Math.round(l/D),a.formatDistance("aboutXMonths",b,i)}if(b=V(x,m),b<12){const h=Math.round(l/D);return a.formatDistance("xMonths",h,i)}else{const h=b%12,N=Math.trunc(b/12);return h<3?a.formatDistance("aboutXYears",N,i):h<9?a.formatDistance("overXYears",N,i):a.formatDistance("almostXYears",N+1,i)}}function te(r,n){return ee(r,K(r),n)}const se=()=>{var O,E;const{auth:r}=I().props,[n,s]=v.useState(!1),[c,a]=v.useState(!1),[d,f]=v.useState(!1),i=v.useRef(null),m=((O=r.user)==null?void 0:O.notifications)||[],x=((E=r.user)==null?void 0:E.unread_count)??0,u=t=>{var o,g;return(g=(o=r==null?void 0:r.user)==null?void 0:o.roles)==null?void 0:g.some(k=>k.name===t)},y=u("admin"),l=u("lecturer"),b=u("admin")||u("university")||u("department_staff");v.useEffect(()=>{const t=o=>{i.current&&!i.current.contains(o.target)&&f(!1)};return document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[]),v.useEffect(()=>{const t=()=>{a(window.innerWidth<768)};return t(),window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]);const h=t=>{const o=t.id,k=(t.data||{}).action_url||null;k?p.visit(k,{onFinish:()=>p.post(`/notifications/${o}/read`),preserveScroll:!0}):p.post(`/notifications/${o}/read`)},N=t=>{try{const o=new Date(t);return te(o,{addSuffix:!0})}catch{return t}},_=Math.max(x,m.filter(t=>!t.read_at).length),X=[{name:"Profile",icon:"person",route:"profile.show",path:"/profile",visible:!y},{name:"Dashboard",icon:"dashboard",route:"dashboard",path:"/dashboard",visible:!0},{name:"Event",icon:"celebration",route:"events.index",path:"/events",visible:!0},{name:"MyEvents",icon:"work_history",route:"events.my-events",path:"/my-events",visible:!0},{name:"Projects",icon:"folder_supervised",route:"projects.index",path:"/projects",visible:y||u("student")},{name:"Project Dashboard",icon:"school",route:"lecturer.dashboard",path:"/lecturer/dashboard",visible:l},{name:"Faculty Students",icon:"groups_3",route:"lecturer.students",path:"/lecturer/students",visible:l},{name:"My Mentees",icon:"group_add",route:"mentees.dashboard",path:"/mentees/dashboard",visible:l},{name:"Reports",icon:"analytics",route:"reports.index",path:"/reports",visible:b},{name:"Connections",icon:"group",route:"friends.list",path:"/friends",visible:u("student")||y},{name:"Notifications",icon:"notifications",badge:_>0?_:null,action:()=>f(!d),visible:!0},{name:"Roles Management",icon:"admin_panel_settings",route:"admin.roles.index",path:"/admin/roles",visible:y},{name:"Settings",icon:"settings",route:"settings.edit",path:"/settings",visible:!0},{name:"Feedback",icon:"feedback",action:()=>window.open("https://forms.gle/ws8WsHAzwWgUfeH7A","_blank","noopener,noreferrer"),visible:!0},{name:"Logout",icon:"logout",method:"post",route:"logout",path:"/logout",visible:!0}],A="/images/logo2.png",w=X.filter(t=>t.visible),T=()=>{const t=window.location.pathname;for(let o=0;o<w.length;o++){const g=w[o];if(g.path&&(t===g.path||g.path!=="/"&&t.startsWith(g.path)))return o}return-1},F=t=>{if(t.action){t.action();return}if(t.method==="post"){p.post(route(t.route));return}t.route?p.get(route(t.route)):t.path&&p.get(t.path)},M=T(),Y=()=>e.jsxs("div",{className:"md:hidden",children:[e.jsxs("button",{onClick:()=>s(!n),className:"fixed top-4 left-4 z-50 p-2 rounded-md bg-white text-[#F37022] border border-orange-200 shadow hover:bg-orange-50 focus:outline-none focus:ring-2 focus:ring-[#F37022] focus:ring-offset-2 focus:ring-offset-white",children:[e.jsx("span",{className:"sr-only",children:"Open menu"}),e.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n?e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"}):e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})]}),n&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40",onClick:()=>s(!1)}),e.jsx("div",{className:"fixed top-16 left-4 z-50 w-56 rounded-lg shadow-xl bg-white border border-orange-200",children:e.jsx("div",{className:"py-1",children:w.map((t,o)=>e.jsxs("button",{onClick:()=>F(t),className:`
                    w-full text-left px-4 py-2 text-sm flex items-center space-x-3
                    ${M===o?"bg-orange-50 text-[#F37022] font-medium":"text-gray-700 hover:bg-orange-50 hover:text-[#F37022]"}
                  `,children:[e.jsx("span",{className:"material-symbols-outlined text-lg",children:t.icon}),e.jsx("span",{children:t.name}),t.name==="Notifications"&&t.badge>0&&e.jsx("span",{className:"ml-auto bg-red-600 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:t.badge})]},o))})})]})]}),R=()=>e.jsx("section",{className:"page sidebar-page hidden md:block",children:e.jsx("aside",{className:"sidebar",children:e.jsxs("div",{className:"inner",children:[e.jsxs("div",{className:"header",children:[e.jsx("img",{src:A,className:"logo",alt:"KooQ Logo"}),e.jsx("h2",{className:"text-black",children:"KooQ"})]}),e.jsx("nav",{className:"menu",style:{"--top":`${M===-1?0:M*56}px`},children:w.map((t,o)=>e.jsxs("button",{className:M===o?"active":"",type:"button",onClick:()=>F(t),style:{position:"relative"},children:[e.jsxs("span",{className:"relative inline-flex items-center justify-center",children:[e.jsx("span",{className:"material-symbols-outlined",children:t.icon}),t.name==="Notifications"&&_>0&&e.jsx("span",{className:"absolute -top-1 -right-1 w-2.5 h-2.5 rounded-full bg-red-600"})]}),e.jsx("p",{children:t.name})]},o))})]})})}),H=()=>d&&e.jsx("div",{ref:i,className:"fixed left-24 top-4 w-96 bg-white dark:bg-gray-800 rounded-lg shadow-2xl border border-gray-200 dark:border-gray-700 overflow-hidden z-[9999] transition-all duration-300 ease-in-out",style:{maxHeight:"80vh",overflowY:"auto"},children:e.jsxs("div",{className:"py-2",children:[e.jsxs("div",{className:"px-4 py-3 font-medium border-b border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900 flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"material-symbols-outlined mr-2",children:"notifications"}),e.jsx("span",{children:"Notifications"})]}),m.length>0&&e.jsx("button",{onClick:()=>p.post("/notifications/mark-all-as-read"),className:"text-xs text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300",children:"Mark all as read"})]}),m.length===0?e.jsxs("div",{className:"px-4 py-12 text-gray-500 dark:text-gray-400 text-center",children:[e.jsx("span",{className:"material-symbols-outlined text-4xl mb-2 opacity-50",children:"notifications_off"}),e.jsx("p",{children:"No new notifications"})]}):e.jsx("div",{children:m.map(t=>e.jsx("div",{className:"px-4 py-3 hover:bg-gray-50 dark:hover:bg-gray-700 border-b border-gray-100 dark:border-gray-700 cursor-pointer transition-colors duration-150",onClick:()=>h(t),children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0 mr-3",children:e.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-100 dark:bg-blue-900 flex items-center justify-center text-blue-500 dark:text-blue-300",children:e.jsx("span",{className:"material-symbols-outlined",children:"event"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-sm font-medium text-gray-800 dark:text-gray-200 mb-1",children:t.data.message||"New notification"}),e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 flex items-center",children:[e.jsx("span",{className:"material-symbols-outlined text-xs mr-1",children:"schedule"}),N(t.created_at)]})]}),!t.read_at&&e.jsx("div",{className:"ml-2 w-2 h-2 bg-blue-600 rounded-full"})]})},t.id))})]})});return e.jsxs(e.Fragment,{children:[e.jsx(Y,{}),e.jsx(R,{}),e.jsx(H,{})]})};function ie({header:r,children:n}){const{auth:s}=I().props;I().props.auth.user;const[c,a]=v.useState(!1);return v.useEffect(()=>{const d=()=>{a(window.innerWidth<768)};return d(),window.addEventListener("resize",d),()=>window.removeEventListener("resize",d)},[]),e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-white to-orange-45 relative overflow-hidden overflow-x-hidden",children:[e.jsx(se,{}),e.jsx("main",{className:`
                transition-all duration-300 ease-in-out
                ${c?"flex flex-col items-center w-full":"ml-[84px]"}
            `,children:e.jsx("div",{className:`
                    ${c?"w-[calc(100%-45px)] mx-auto flex justify-center":""}
                `,children:n})})]})}export{ie as A};
